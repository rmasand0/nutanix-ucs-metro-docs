Module 5: Day 2 OperationsOnce Nutanix Metro Availability is live on your Cisco UCS nodes, the focus shifts from implementation to Lifecycle Management. This involves non-disruptive testing, firmware updates, and scaling the cluster.1. Non-Disruptive Failover TestingTo maintain compliance (and peace of mind), you must test the Metro failover. We differentiate between a "Planned Switchover" and a "Disruptive Test."The Planned Switchover (No Downtime)Use this for maintenance on Site A’s Cisco Fabric Interconnects or power systems.Preparation: Ensure the container status is Synchronous.Action: In Prism, select the Protection Domain and click Pause.Migration: Move VMs from Site A to Site B using vMotion or AHV Live Migration.Promote: On Site B, click Promote.Result: Site B is now the "Active" site. I/O is local to Site B.The Disruptive Test (Simulated Disaster)Verify the Witness VM is healthy.Physically or administratively shut down the Uplink ports on the Site A Cisco FIs.Observation: Watch the Witness promote Site B automatically. Verify that VMs restart on Site B within the expected RTO (typically 2–5 minutes depending on the number of VMs).2. Scaling the InfrastructureAdding a node to a Metro cluster requires specific steps to ensure the new hardware matches the performance profile of the existing nodes.Adding Cisco UCS M7 NodesTemplate Consistency: Always derive the new Service Profile from the existing Nutanix-Metro-Template created in Module 2.Network Parity: Ensure the 25GbE/100GbE uplinks for the new node are patched into the same Fabric Interconnects as the rest of the cluster.Data Locality: After adding the node to the Nutanix cluster, the "Curator" process will rebalance data.Warning: Do not move high-priority VMs to the new node until the disk rebalancing is at least 60% complete, or you may experience "Remote Reads" across the ISL.3. Maintenance Mode & Firmware UpdatesUpdating Cisco UCS Firmware (Infrastructure & Server bundles) must be done with care in a Metro environment.FI Updates: When updating the Fabric Interconnects, do one site at a time.CVM Awareness: Before rebooting a UCS Blade for firmware updates, always put the Nutanix node into Maintenance Mode. This ensures that Metro Availability is aware the node is down and won't trigger unnecessary Witness heartbeats.Bash# Command to put a Nutanix node into maintenance mode via CLI
ncli host edit id=<host_id> enable-maintenance-mode=true
4. Operational Health ChecklistPrincipal Engineers should perform this "Quick Look" audit weekly:MetricTargetToolReplication HealthSynchronousPrism / ncliWitness StatusConnectedncli witness lsRTT Latency< 5msping / Prism PerformanceUCS FI Errors0 CRC ErrorsUCS Manager / Cisco IntersightRack2Cloud Tip: A sudden rise in CRC Errors on your Cisco UCS Uplink ports is an early warning sign of a failing SFP or fiber strand. In a Metro cluster, this leads to "dropped write ACKs" and can cause the cluster to flap between sites.ConclusionYou have now completed the Nutanix Metro Availability on Cisco UCS Engineering Guide. By following this modular approach, you have ensured that the hardware (Cisco UCS), the software (Nutanix AHV/ESXi), and the arbitrator (Witness) are all aligned for maximum resilience.
